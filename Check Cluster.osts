{"version":"0.3.0","body":"\nfunction main(workbook: ExcelScript.Workbook) {\n  let dict = {};\n  let new_dict = {};\n  // Получаване на активната клетка и работен лист.\n  let selectedSheet = workbook.getActiveWorksheet();\n\n  // selectedCell.getFormat().getFill().setColor(\"yellow\");\n\n  let myUsedRange = selectedSheet.getUsedRange();\n  let lastRow = myUsedRange.getRowCount();\n  for (let i = 0; i < lastRow - 1; i++) {\n    let range_cluster = selectedSheet.getRange(\"M\"+(i+2));\n    let range_expire_date = selectedSheet.getRange(\"K\"+(i+2));\n    dict[range_cluster.getValue()] = [];\n  }\n\n  for (let i = 0; i < lastRow - 1; i++) {\n    let range_cluster = selectedSheet.getRange(\"M\" + (i + 2));\n    let range_expire_date = selectedSheet.getRange(\"K\" + (i + 2));\n    dict[range_cluster.getValue()].push(range_expire_date.getValue());\n  }\n\n  let keys = Object.keys(dict);\n\n  for (let i = 0; i < keys.length; i++) {\n    let keys_value = Object.values(dict[keys[i]]);\n    for (let j = 0; j < keys_value.length - 1; j++) {\n      if (dict[keys[i]][j] != dict[keys[i]][j+1]) {\n        new_dict[keys[i]] = \"X\";\n        break;\n      }\n    }\n  }\n\n  for (let i = 0; i < lastRow - 1; i++) {\n    let range_cluster = selectedSheet.getRange(\"M\" + (i + 2));\n    let diff_value = selectedSheet.getRange(\"Q\" + (i + 2));\n    if (new_dict.hasOwnProperty(range_cluster.getValue())) {\n      diff_value.setValue(\"X\")\n      console.log(`${i+2}: ${range_cluster} have different expire value.`)\n    }\n  }\n}\n","description":"","copilotMetadata":null,"parameterInfo":"{\"version\":1,\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}},\"signature\":{\"comment\":\"\",\"parameters\":[{\"name\":\"workbook\",\"comment\":\"\"}]}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}